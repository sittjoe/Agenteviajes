<!DOCTYPE html>
<html lang="es-MX">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#f59e0b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Magia Disney & Royal</title>
    <link rel="manifest" href="manifest.json">
    <link rel="preload" href="assets/fonts/Inter-Variable.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="icon" href="assets/logo.png">
    <link rel="apple-touch-icon" href="assets/logo.png">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/print.css" media="print">
</head>

<body>
    <div class="app-shell">
        <aside class="sidebar">
            <div class="sidebar-brand">
                <img src="assets/logo-premium.jpg" alt="Logo" class="sidebar-logo" onerror="this.style.display='none'">
                <div>
                    <p class="eyebrow">Suite de ventas</p>
                    <h2 class="sidebar-title">Magia Disney & Royal</h2>
                    <p class="sidebar-sub">Operable como app o como p√°gina p√∫blica</p>
                </div>
            </div>
            <div class="sidebar-nav">
                <button class="nav-item active" data-tab="inicio" onclick="App.showTab('inicio', this)">
                    <span class="icon">üè†</span><span>Inicio</span>
                </button>
                <button class="nav-item" data-tab="cotizar" onclick="App.showTab('cotizar', this)">
                    <span class="icon">üìù</span><span>Cotizar</span>
                </button>
                <button class="nav-item" data-tab="info" onclick="App.showTab('info', this)">
                    <span class="icon">üìö</span><span>Info</span>
                </button>
                <button class="nav-item" data-tab="tools" onclick="App.showTab('tools', this)">
                    <span class="icon">üßÆ</span><span>Tools</span>
                </button>
                <button class="nav-item" data-tab="ajustes" onclick="App.showTab('ajustes', this)">
                    <span class="icon">‚öôÔ∏è</span><span>Ajustes</span>
                </button>
            </div>
            <div class="sidebar-cta">
                <p>Arranca como PWA o mu√©stralo como web: todo est√° listo para atender clientes.</p>
                <button class="btn-primary btn-block" onclick="App.showTab('cotizar'); App.showNewQuote();">‚ûï Nueva
                    cotizaci√≥n</button>
            </div>
        </aside>
        <div class="app-area">
            <header class="header">
                <div class="header-title">
                    <p class="eyebrow">Panel ejecutivo</p>
                    <h1>Magia Disney & Royal</h1>
                    <span>Parques ‚Ä¢ Cruceros ‚Ä¢ Descuentos</span>
                </div>
                <div class="header-actions">
                    <div class="header-search">
                        <span class="search-icon">üîç</span>
                        <input type="text" id="globalSearch" class="search-input" placeholder="Buscar respuestas..."
                            oninput="App.handleSearch()" onfocus="App.showSearchResults()"
                            onblur="App.hideSearchResults()">
                        <div id="searchResults" class="search-results"></div>
                    </div>
                    <div class="header-buttons">
                        <button class="btn-secondary" onclick="App.showTab('cotizar'); App.showNewQuote();">Nueva
                            cotizaci√≥n</button>
                        <button class="header-btn" onclick="App.toggleDarkMode()" title="Modo oscuro"
                            aria-label="Alternar modo oscuro">üåô</button>
                    </div>
                </div>
            </header>

            <main class="main-content">
                <!-- TAB: INICIO -->
                <div id="tab-inicio" class="tab-content active">
                    <div id="home-main" class="screen active">
                        <div class="hero-grid">
                            <div class="welcome-card">
                                <div class="welcome-grid">
                                    <div class="welcome-copy">
                                        <p class="eyebrow">Escritorio ejecutivo</p>
                                        <h2 class="welcome-title">Atiende como concierge, responde como experto.</h2>
                                        <p class="welcome-sub">Organiza respuestas, cotizaciones y seguimiento con un
                                            tono impecable y procesos claros.</p>
                                        <div class="cta-row">
                                            <button class="btn-primary"
                                                onclick="App.showTab('cotizar'); App.showNewQuote();">‚ûï Nueva
                                                cotizaci√≥n</button>
                                            <button class="btn-ghost"
                                                onclick="App.switchTab('crm'); App.showTab('tools');">üë• Abrir
                                                CRM</button>
                                        </div>
                                    </div>
                                    <div class="welcome-stats">
                                        <div class="metric-card">
                                            <p class="metric-label">Cotizaciones activas</p>
                                            <p id="home-total-quotes" class="metric-value">0</p>
                                        </div>
                                        <div class="metric-card">
                                            <p class="metric-label">Aceptadas</p>
                                            <p id="home-accepted" class="metric-value">0</p>
                                        </div>
                                        <div class="metric-card">
                                            <p class="metric-label">Conversi√≥n</p>
                                            <p id="home-conversion" class="metric-value">0%</p>
                                        </div>
                                        <div class="metric-card">
                                            <p class="metric-label">Pendientes</p>
                                            <p id="home-pending" class="metric-value">0</p>
                                        </div>
                                    </div>
                                </div>
                                <div id="home-insight" class="insight-banner">Estado listo para operar.</div>
                            </div>

                            <div class="business-card">
                                <div>
                                    <p class="eyebrow">Identidad del agente</p>
                                    <h3 id="business-name">Magia Disney & Royal</h3>
                                    <p id="business-slogan" class="business-sub">Parques ‚Ä¢ Cruceros ‚Ä¢ Descuentos</p>
                                    <div class="contact-grid">
                                        <div class="contact-chip" onclick="App.copyBusinessContact('phone')">
                                            <div class="chip-icon">üìû</div>
                                            <div>
                                                <p class="chip-label">Tel√©fono</p>
                                                <p id="business-phone" class="chip-value">55 8095 5139</p>
                                            </div>
                                        </div>
                                        <div class="contact-chip" onclick="App.copyBusinessContact('email')">
                                            <div class="chip-icon">‚úâÔ∏è</div>
                                            <div>
                                                <p class="chip-label">Email</p>
                                                <p id="business-email" class="chip-value">Configura tu correo</p>
                                            </div>
                                        </div>
                                        <div class="contact-chip" onclick="App.copyBusinessContact('instagram')">
                                            <div class="chip-icon">üì∏</div>
                                            <div>
                                                <p class="chip-label">Instagram</p>
                                                <p id="business-ig" class="chip-value">@magia</p>
                                            </div>
                                        </div>
                                        <div class="contact-chip" onclick="App.copyBusinessContact('facebook')">
                                            <div class="chip-icon">üìò</div>
                                            <div>
                                                <p class="chip-label">Facebook</p>
                                                <p id="business-fb" class="chip-value">/magia</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="business-actions">
                                    <p class="business-note">Comparte cualquier dato con un clic. Ajusta los valores en
                                        <b>Ajustes ‚Üí Datos del negocio</b>.
                                    </p>
                                    <button class="btn-secondary" onclick="App.showTab('ajustes');">‚öôÔ∏è Ajustar
                                        datos</button>
                                </div>
                            </div>
                        </div>

                        <div class="surface-panel">
                            <div class="section-header">
                                <div>
                                    <p class="eyebrow">Acciones inmediatas</p>
                                    <span class="section-title">Responde, agenda o da seguimiento</span>
                                </div>
                                <button class="btn-ghost" onclick="App.showTab('tools'); App.switchTab('crm');">Abrir
                                    CRM</button>
                            </div>
                            <div class="quick-grid">
                                <div class="quick-btn" onclick="App.showResponse('saludo')"><span
                                        class="emoji">üëã</span><span class="label">Saludar</span></div>
                                <div class="quick-btn" onclick="App.showResponse('pedir_datos')"><span
                                        class="emoji">üìã</span><span class="label">Pedir datos</span></div>
                                <div class="quick-btn" onclick="App.showResponse('precio_caro')"><span
                                        class="emoji">üí∏</span><span class="label">"Est√° caro"</span></div>
                                <div class="quick-btn" onclick="App.showResponse('plan_pagos')"><span
                                        class="emoji">üí≥</span><span class="label">Plan pagos</span></div>
                                <div class="quick-btn" onclick="App.showResponse('no_contesta')"><span
                                        class="emoji">üîî</span><span class="label">No contesta</span></div>
                                <div class="quick-btn" onclick="App.showResponse('cerrar')"><span
                                        class="emoji">‚úÖ</span><span class="label">Cerrar venta</span></div>
                            </div>
                        </div>
                        <div class="surface-panel">
                            <div class="section-header"><span class="section-title">üìä Etapa del cliente</span></div>
                            <div class="stage-grid">
                                <div class="stage-btn" onclick="App.showStage('nuevo')"><span class="icon">üÜï</span>
                                    <div class="content">
                                        <div class="title">Cliente nuevo</div>
                                        <div class="subtitle">Primer contacto</div>
                                    </div><span class="arrow">‚Üí</span>
                                </div>
                                <div class="stage-btn" onclick="App.showStage('preguntando')"><span
                                        class="icon">üí¨</span>
                                    <div class="content">
                                        <div class="title">Preguntando</div>
                                        <div class="subtitle">Dudas, informaci√≥n</div>
                                    </div><span class="arrow">‚Üí</span>
                                </div>
                                <div class="stage-btn" onclick="App.showStage('cotizado')"><span class="icon">üìã</span>
                                    <div class="content">
                                        <div class="title">Ya cotizado</div>
                                        <div class="subtitle">Objeciones, seguimiento</div>
                                    </div><span class="arrow">‚Üí</span>
                                </div>
                                <div class="stage-btn" onclick="App.showStage('cerrar')"><span class="icon">‚úÖ</span>
                                    <div class="content">
                                        <div class="title">Cerrar venta</div>
                                        <div class="subtitle">Confirmaci√≥n</div>
                                    </div><span class="arrow">‚Üí</span>
                                </div>
                                <div class="stage-btn" onclick="App.showStage('postventa')"><span class="icon">üéâ</span>
                                    <div class="content">
                                        <div class="title">Post-venta</div>
                                        <div class="subtitle">Seguimiento, referidos</div>
                                    </div><span class="arrow">‚Üí</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="home-stage" class="screen">
                        <div class="back-row"><button class="back-btn" onclick="App.backToHome()">‚Üê Volver</button>
                            <h2 id="stage-title" class="screen-title"></h2>
                        </div>
                        <div id="situations-list"></div>
                    </div>
                    <div id="home-response" class="screen">
                        <div class="back-row"><button class="back-btn" onclick="App.backToStage()">‚Üê Volver</button>
                        </div>
                        <div id="response-breadcrumb" class="breadcrumb"></div>
                        <div id="response-content"></div>
                    </div>
                </div>

                <!-- TAB: COTIZAR -->
                <div id="tab-cotizar" class="tab-content">
                    <div id="quotes-list" class="screen active">
                        <div class="section-header" style="margin-bottom:16px;">
                            <h2 style="font-size:20px;font-weight:700;">üìù Cotizaciones</h2><button
                                class="btn-primary btn-sm" onclick="App.showNewQuote()">‚ûï Nueva</button>
                        </div>
                        <div class="search-container" style="margin-bottom:16px;"><span
                                class="search-icon">üîç</span><input type="text" id="quoteSearch" class="search-input"
                                placeholder="Buscar por cliente..." oninput="App.filterQuotes()"></div>
                        <div id="quotes-list-container"></div>
                    </div>
                    <div id="quote-form" class="screen">
                        <div class="back-row"><button class="back-btn" onclick="App.showQuotesList()">‚Üê Volver</button>
                            <h2 id="quote-form-title" class="screen-title">üìù Nueva Cotizaci√≥n</h2>
                        </div>
                        <div id="quote-preview" class="quote-preview">
                            <p class="preview-empty">Llena los campos para ver la vista previa...</p>
                        </div>
                        <div class="form-group"><label class="form-label">N√∫mero</label><input type="text" id="quote-id"
                                class="form-input" readonly style="background:var(--bg-alt);"></div>
                        <div class="card ai-card">
                            <div class="card-title">ü§ñ Crear cotizaci√≥n con IA + fotos</div>
                            <p class="muted" style="margin-bottom:12px;">Sube fotos con los detalles del viaje (capturas de pantalla, itinerarios, tablas) y agrega contexto. La IA leer√° las im√°genes y rellenar√° la cotizaci√≥n.</p>
                            <div id="ai-dropzone" class="ai-dropzone" onclick="document.getElementById('ai-file-input').click()" ondragover="App.handleAIDragOver(event)" ondragenter="App.handleAIDragOver(event)" ondragleave="App.handleAIDragLeave(event)" ondrop="App.handleAIDrop(event)">
                                <div class="ai-drop-icon">üì∏</div>
                                <div>
                                    <div class="ai-drop-title">Arrastra im√°genes o toca para subir</div>
                                    <div class="ai-drop-sub">JPG, PNG, HEIC ‚Ä¢ Hasta 4 fotos</div>
                                </div>
                                <input id="ai-file-input" type="file" accept="image/*" multiple onchange="App.handleAIFileInput(event)">
                            </div>
                            <div id="ai-upload-list" class="ai-upload-list"></div>
                            <div class="form-group"><label class="form-label">Qu√© debe proponer la IA</label><textarea
                                    id="ai-notes" class="form-textarea"
                                    placeholder="Ej. Familia de 4 (2 ni√±os 5 y 9). Crucero Disney Wish, julio, presupuesto 4200 USD. Quiero propuesta premium y plan de pagos suave."></textarea>
                            </div>
                            <div class="form-row ai-actions">
                                <button id="ai-generate-btn" type="button" class="btn-primary" onclick="App.generateQuoteFromAI()">‚ú® Crear con IA</button>
                                <button type="button" class="btn-ghost" onclick="App.resetAIQuoteInputs()">Limpiar</button>
                            </div>
                            <p class="muted" style="font-size:12px;margin-top:4px;">Necesitas tu clave de OpenAI (Ajustes ‚Üí IA). Se guarda solo en este dispositivo.</p>
                        </div>
                        <div class="card">
                            <div class="card-title">üë§ Cliente</div>
                            <div class="form-group"><label class="form-label required">Nombre</label><input type="text"
                                    id="quote-client-name" class="form-input" placeholder="Familia Garc√≠a"
                                    oninput="App.markQuoteChanged();App.updateQuotePreview()"></div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label">Tel√©fono</label><input type="tel"
                                        id="quote-client-phone" class="form-input" placeholder="55 1234 5678"
                                        oninput="App.markQuoteChanged()"></div>
                                <div class="form-group"><label class="form-label">Email</label><input type="email"
                                        id="quote-client-email" class="form-input" placeholder="email@ejemplo.com"
                                        oninput="App.markQuoteChanged()"></div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-title">‚úàÔ∏è Viaje</div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label">Tipo</label><select id="quote-type"
                                        class="form-select" onchange="App.markQuoteChanged();App.updateQuotePreview();App.applyQuoteTemplate();">
                                        <option value="crucero-disney">üö¢ Crucero Disney</option>
                                        <option value="crucero-royal">‚öì Royal Caribbean</option>
                                        <option value="parques-wdw">üè∞ Disney World</option>
                                        <option value="parques-dl">üé¢ Disneyland</option>
                                        <option value="hotel-disney">üè® Hotel Disney</option>
                                        <option value="paquete">üì¶ Paquete</option>
                                        <option value="otro">‚úàÔ∏è Otro</option>
                                    </select></div>
                                <div class="form-group"><label class="form-label">Estado</label><select
                                        id="quote-status" class="form-select" onchange="App.markQuoteChanged()">
                                        <option value="draft">üìù Borrador</option>
                                        <option value="sent">üì§ Enviada</option>
                                        <option value="negotiating">üí¨ Negociando</option>
                                        <option value="accepted">‚úÖ Aceptada</option>
                                        <option value="rejected">‚ùå Rechazada</option>
                                    </select></div>
                            </div>
                            <div class="form-group"><label class="form-label required">Producto / Destino</label><input
                                    type="text" id="quote-product" class="form-input"
                                    placeholder="Disney Wish - Bahamas 4 noches"
                                    oninput="App.markQuoteChanged();App.updateQuotePreview()"></div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label">Fecha salida</label><input type="date"
                                        id="quote-date-start" class="form-input"
                                        oninput="App.markQuoteChanged();App.updateQuotePreview()"></div>
                                <div class="form-group"><label class="form-label">Fecha regreso</label><input
                                        type="date" id="quote-date-end" class="form-input"
                                        oninput="App.markQuoteChanged();App.updateQuotePreview()"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Adultos</label>
                                    <select id="quote-adults" class="form-select"
                                        onchange="App.markQuoteChanged();App.updateQuotePreview()">
                                        <option value="1">1</option>
                                        <option value="2" selected>2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Ni√±os</label>
                                    <select id="quote-children" class="form-select"
                                        onchange="App.markQuoteChanged();App.updateQuotePreview();App.updateChildrenAges()">
                                        <option value="0" selected>0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group"><label class="form-label">Qu√© incluye</label><textarea
                                    id="quote-includes" class="form-textarea"
                                    placeholder="Hospedaje&#10;Boletos&#10;Transporte"
                                    oninput="App.markQuoteChanged()"></textarea></div>
                            <div class="form-group"><label class="form-label">Qu√© NO incluye</label><textarea
                                    id="quote-excludes" class="form-textarea"
                                    placeholder="Vuelos&#10;Comidas&#10;Propinas"
                                    oninput="App.markQuoteChanged()"></textarea></div>
                            <div class="form-group"><label class="form-label">Itinerario / plan del viaje</label><textarea
                                    id="quote-itinerary" class="form-textarea"
                                    placeholder="D√≠a 1: Llegada y check-in&#10;D√≠a 2: Parque Magic Kingdom&#10;D√≠a 3: Disney Wish zarpa..."
                                    oninput="App.markQuoteChanged()"></textarea></div>
                        </div>
                        <div class="card">
                            <div class="card-title">üí∞ Inversi√≥n</div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label required">Total (USD)</label><input
                                        type="number" id="quote-total" class="form-input" placeholder="3500"
                                        oninput="App.markQuoteChanged();App.calculateMonthly()"></div>
                                <div class="form-group"><label class="form-label">Apartado</label><input type="number"
                                        id="quote-deposit" class="form-input" placeholder="200"
                                        oninput="App.markQuoteChanged();App.calculateMonthly()"></div>
                            </div>
                            <div class="form-group"><label class="form-label">Meses</label><input type="range"
                                    id="quote-months" class="calc-slider" min="1" max="12" value="6"
                                    oninput="App.markQuoteChanged();App.calculateMonthly()">
                                <div id="monthly-display" class="months-display">$0/mes</div>
                            </div>
                            <div id="children-ages-container"></div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label">Pago final</label><input type="date"
                                        id="quote-deadline" class="form-input" oninput="App.markQuoteChanged()"></div>
                                <div class="form-group"><label class="form-label">V√°lida hasta</label><input type="date"
                                        id="quote-valid-until" class="form-input" oninput="App.markQuoteChanged()">
                                </div>
                            </div>
                            <div class="form-group"><label class="form-label">Plan de pagos detallado</label><textarea
                                    id="quote-payment-plan" class="form-textarea"
                                    placeholder="Ej. Apartado hoy: $200 USD&#10;Pago 1: 15 de mayo&#10;Pago final: 30 de junio"
                                    oninput="App.markQuoteChanged()"></textarea></div>
                            <div class="form-group"><label class="form-label">Link de pago / CTA</label><input
                                    type="url" id="quote-payment-link" class="form-input"
                                    placeholder="https://pago.com/tu-link" oninput="App.markQuoteChanged()"></div>
                            <div class="form-group"><label class="form-label">Pr√≥ximos pasos (para cliente)</label><textarea
                                    id="quote-next-steps" class="form-textarea"
                                    placeholder="1) Confirmar datos de viajeros&#10;2) Realizar apartado hoy&#10;3) Subir pasaportes"
                                    oninput="App.markQuoteChanged()"></textarea></div>
                        </div>
                        <div class="card">
                            <div class="card-title">üìù Notas</div>
                            <div class="form-group"><label class="form-label">Notas internas</label><textarea
                                    id="quote-notes-internal" class="form-textarea" placeholder="Solo para ti..."
                                    oninput="App.markQuoteChanged()"></textarea></div>
                            <div class="form-group"><label class="form-label">Notas cliente</label><textarea
                                    id="quote-notes-client" class="form-textarea" placeholder="Para el cliente..."
                                    oninput="App.markQuoteChanged()"></textarea></div>
                        </div>
                        <div class="action-row"><button class="btn-primary" onclick="App.saveQuote()">üíæ
                                Guardar</button><button class="btn-secondary" onclick="App.generatePDF()">üìÑ Exportar
                                PDF</button><button class="btn-secondary" onclick="App.copyQuoteText()">üìã
                                Copiar</button></div>
                    </div>
                    <div id="quote-view" class="screen">
                        <div class="back-row"><button class="back-btn" onclick="App.showQuotesList()">‚Üê Volver</button>
                        </div>
                        <div id="view-quote-content"></div>
                        <div class="action-row"><button class="btn-whatsapp" onclick="App.sendQuoteWhatsApp()">üí¨
                                WhatsApp</button><button class="btn-secondary" onclick="App.copyCurrentQuoteText()">üìã
                                Copiar</button><button class="btn-secondary" onclick="App.openPublicQuote()">üåê Portal</button>
                        </div>
                        <div class="action-row"><button class="btn-primary" onclick="App.generatePDF()">üìÑ Exportar
                                PDF</button><button class="btn-secondary"
                                onclick="App.editQuote(App.state.viewingQuoteId)">‚úèÔ∏è
                                Editar</button><button class="btn-secondary" onclick="App.duplicateQuote()">üìã
                                Duplicar</button>
                        </div>
                        <div class="action-row"><button class="btn-danger btn-sm" onclick="App.deleteQuote()">üóëÔ∏è
                                Eliminar</button></div>
                    </div>
                </div>

                <!-- TAB: INFO -->
                <div id="tab-info" class="tab-content">
                    <h2 style="font-size:20px;font-weight:700;margin-bottom:16px;">üìö Informaci√≥n y respuestas</h2>
                    <div class="info-card open">
                        <div class="info-card-header" onclick="App.toggleInfoCard(this)"><span
                                class="icon">üí¨</span><span class="title">Respuestas r√°pidas (WhatsApp)</span><span
                                class="arrow">‚ñº</span></div>
                        <div class="info-card-body open">
                            <div class="info-filters">
                                <div class="filter-field">
                                    <label for="quick-response-search">Buscar</label>
                                    <input type="text" id="quick-response-search" class="form-input"
                                        placeholder="Ej. pagar a meses, kids sail free"
                                        oninput="App.filterQuickResponses()">
                                </div>
                                <div class="filter-field">
                                    <label for="quick-response-stage">Etapa</label>
                                    <select id="quick-response-stage" class="form-select"
                                        onchange="App.filterQuickResponses()">
                                        <option value="all">Todas</option>
                                    </select>
                                </div>
                            </div>
                            <div id="quick-responses-grid" class="response-grid"></div>
                        </div>
                    </div>

                    <div id="product-info-cards"></div>
                    <div class="wdw-guide-card">
                        <div class="wdw-guide-header">
                            <div>
                                <p class="wdw-guide-kicker">Gu√≠a expr√©s, visual e interactiva</p>
                                <h3>Plan maestro para cada parque de Walt Disney World</h3>
                                <p class="wdw-guide-sub">Elige un parque y obt√©n atracciones imperdibles, estrategia de
                                    Lightning Lane,
                                    snacks y un recorrido de d√≠a perfecto.</p>
                            </div>
                            <div class="wdw-guide-badges">
                                <span>üåÖ Rope drop</span>
                                <span>‚ö° Lightning Lane</span>
                                <span>üç¶ Snacks ic√≥nicos</span>
                            </div>
                        </div>
                        <div class="wdw-selector" id="wdw-park-selector"></div>
                        <div id="wdw-park-detail" class="wdw-park-detail"></div>
                    </div>
                </div>

                <!-- TAB: TOOLS -->
                <div id="tab-tools" class="tab-content">
                    <h2 style="font-size:20px;font-weight:700;margin-bottom:16px;">üßÆ Herramientas</h2>

                    <!-- Navegaci√≥n de herramientas -->
                    <div class="tools-nav">
                        <button class="tools-nav-btn active" onclick="App.switchTab('tools-main')"
                            data-view="tools-main">üßÆ Calculadora</button>
                        <button class="tools-nav-btn" onclick="App.switchTab('pipeline')" data-view="pipeline">üìä
                            Pipeline</button>
                        <button class="tools-nav-btn" onclick="App.switchTab('crm')" data-view="crm">üë•
                            Clientes</button>
                        <button class="tools-nav-btn" onclick="App.switchTab('analytics')" data-view="analytics">üìà
                            Analytics</button>
                        <button class="tools-nav-btn" onclick="App.switchTab('reminders')" data-view="reminders">‚è∞ Recordatorios</button>
                    </div>

                    <!-- Vista principal de herramientas -->
                    <div id="view-tools-main" class="view-section" style="display: block;">
                        <div class="calculator">
                            <h3 style="font-size:16px;font-weight:600;margin-bottom:16px;">üí∞ Calculadora de pagos</h3>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label">Total (USD)</label><input
                                        type="number" id="calc-total" class="form-input" placeholder="3500"
                                        oninput="App.calculatePayment()">
                                </div>
                                <div class="form-group"><label class="form-label">Apartado</label><input type="number"
                                        id="calc-deposit" class="form-input" placeholder="200"
                                        oninput="App.calculatePayment()">
                                </div>
                            </div>
                            <div class="form-group"><label class="form-label">Meses</label><input type="range"
                                    id="calc-months" class="calc-slider" min="1" max="12" value="6"
                                    oninput="App.calculatePayment()">
                                <div id="calc-months-label" class="months-display">6 meses</div>
                            </div>
                            <div class="calc-result-box">
                                <div id="calc-result" class="calc-result">$0</div>
                                <div class="calc-result-label">por mes</div>
                            </div>
                            <button class="btn-success btn-block" onclick="App.copyCalcResult()">üìã Copiar plan</button>
                        </div>
                        <div class="checklist">
                            <div
                                style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                                <h3 style="font-size:16px;font-weight:600;">üìã Checklist datos</h3><button
                                    class="btn-secondary btn-sm" onclick="App.resetChecklist()">üîÑ</button>
                            </div>
                            <div class="checklist-item" data-id="names" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Nombres completos</span>
                            </div>
                            <div class="checklist-item" data-id="birthdays" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Fechas nacimiento</span>
                            </div>
                            <div class="checklist-item" data-id="email" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Email</span>
                            </div>
                            <div class="checklist-item" data-id="phone" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Tel√©fono</span>
                            </div>
                            <div class="checklist-item" data-id="passport" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Pasaporte</span>
                            </div>
                            <div class="checklist-item" data-id="passportExp" onclick="App.toggleCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Vencimiento pasaporte</span>
                            </div>
                            <button class="btn-secondary btn-block btn-sm" style="margin-top:12px;"
                                onclick="App.copyChecklist()">üìã
                                Copiar pendientes</button>
                        </div>
                        <div class="checklist">
                            <div
                                style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                                <h3 style="font-size:16px;font-weight:600;">üß≥ Checklist de viaje (para el cliente)</h3><button
                                    class="btn-secondary btn-sm" onclick="App.resetClientChecklist()">üîÑ</button>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="docs" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Pasaportes y visas vigentes</span>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="payment" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Pago/apartado realizado</span>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="insurance" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Seguro de viaje</span>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="checkin" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Check-in (crucero/parques) completado</span>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="transfers" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Traslados confirmados</span>
                            </div>
                            <div class="checklist-item client-checklist-item" data-id="extras" onclick="App.toggleClientCheckItem(this)">
                                <div class="checkbox">‚úì</div><span class="checklist-text">Restaurantes/actividades reservadas</span>
                            </div>
                            <button class="btn-secondary btn-block btn-sm" style="margin-top:12px;"
                                onclick="App.copyClientChecklist()">üìã Copiar para enviar</button>
                        </div>
                        <div class="card">
                            <div class="card-title">üìä Estad√≠sticas</div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div id="stat-total-quotes" class="stat-value">0</div>
                                    <div class="stat-label">Cotizaciones</div>
                                </div>
                                <div class="stat-card">
                                    <div id="stat-accepted" class="stat-value">0</div>
                                    <div class="stat-label">Aceptadas</div>
                                </div>
                                <div class="stat-card">
                                    <div id="stat-conversion" class="stat-value">0%</div>
                                    <div class="stat-label">Conversi√≥n</div>
                                </div>
                                <div class="stat-card">
                                    <div id="stat-pending" class="stat-value">0</div>
                                    <div class="stat-label">Pendientes</div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">Por estado</div>
                                <div id="status-chart"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">Por producto</div>
                                <div id="type-chart"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Pipeline View -->
                    <div id="view-pipeline" class="view-section" style="display: none;">
                        <div class="crm-header">
                            <h2>üìä Pipeline de Ventas</h2>
                            <div class="pipeline-filters">
                                <select id="pipeline-filter-date" class="form-select-sm">
                                    <option value="all">Todo el tiempo</option>
                                    <option value="month">Este mes</option>
                                </select>
                            </div>
                        </div>
                        <div id="pipeline-quotes-list" class="quotes-list">
                            <!-- Quotes rendered here -->
                        </div>
                    </div>

                    <!-- CRM View -->
                    <div id="view-crm" class="view-section" style="display: none;">
                        <div class="crm-header">
                            <h2>üë• Clientes</h2>
                            <button class="btn-primary btn-sm" onclick="CRM_UI.showAddClientModal()">‚ûï Nuevo</button>
                        </div>
                        <div class="search-container" style="margin-bottom:16px;">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="clientSearch" class="search-input" placeholder="Buscar clientes..."
                                oninput="CRM_UI.renderClientList(this.value)">
                        </div>
                        <div id="client-list-container" class="client-list"></div>
                    </div>

                    <!-- Analytics View -->
                    <div id="view-analytics" class="view-section" style="display: none;">
                        <div class="crm-header">
                            <h2>üìà Analytics & Reportes</h2>
                            <div class="date-range">
                                <select id="analytics-period" class="form-select-sm"
                                    onchange="Analytics_UI.renderDashboard()">
                                    <option value="month">Este Mes</option>
                                    <option value="quarter">Este Trimestre</option>
                                    <option value="year">Este A√±o</option>
                                </select>
                            </div>
                        </div>

                        <div class="analytics-grid">
                            <!-- KPI Cards -->
                            <div class="kpi-card">
                                <div class="kpi-label">Ventas Totales</div>
                                <div class="kpi-value" id="kpi-total-sales">$0</div>
                                <div class="kpi-trend positive">‚Üë 12% vs mes anterior</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label">Cotizaciones</div>
                                <div class="kpi-value" id="kpi-total-quotes">0</div>
                                <div class="kpi-trend neutral">-- vs mes anterior</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label">Tasa de Cierre</div>
                                <div class="kpi-value" id="kpi-conversion">0%</div>
                                <div class="kpi-trend positive">‚Üë 2% vs mes anterior</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label">Comisiones Est.</div>
                                <div class="kpi-value" id="kpi-commissions">$0</div>
                                <div class="kpi-trend positive">‚Üë 8% vs mes anterior</div>
                            </div>

                            <!-- Charts -->
                            <div class="chart-container wide">
                                <h3>Tendencia de Ventas</h3>
                                <canvas id="salesChart"></canvas>
                            </div>
                            <div class="chart-container">
                                <h3>Destinos Top</h3>
                                <canvas id="destinationsChart"></canvas>
                            </div>
                            <div class="chart-container">
                                <h3>Fuentes de Leads</h3>
                                <canvas id="leadsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Reminders View -->
                    <div id="view-reminders" class="view-section" style="display: none;">
                        <div class="crm-header">
                            <h2>‚è∞ Recordatorios</h2>
                            <button class="btn-primary btn-sm" onclick="App.addReminder()">‚ûï Nuevo</button>
                        </div>
                        <div id="reminders-list" class="card"></div>
                    </div>
                </div>

                <!-- TAB: AJUSTES -->
                <div id="tab-ajustes" class="tab-content">
                    <h2 style="font-size:20px;font-weight:700;margin-bottom:16px;">‚öôÔ∏è Ajustes</h2>
                    <div class="config-section">
                        <div class="config-section-title">üë§ Mis datos</div>
                        <div class="form-group"><label class="form-label">WhatsApp</label><input type="tel"
                                id="config-phone" class="form-input" placeholder="55 8095 5139"></div>
                        <div class="form-group"><label class="form-label">Email</label><input type="email"
                                id="config-email" class="form-input" placeholder="tu@email.com"></div>
                        <div class="form-row">
                            <div class="form-group"><label class="form-label">Instagram</label><input type="text"
                                    id="config-instagram" class="form-input" placeholder="@usuario"></div>
                            <div class="form-group"><label class="form-label">Facebook</label><input type="text"
                                    id="config-facebook" class="form-input" placeholder="P√°gina"></div>
                        </div>
                    </div>
                    <div class="config-section">
                        <div class="config-section-title">üìù Cotizaciones</div>
                        <div class="form-row">
                            <div class="form-group"><label class="form-label">Prefijo</label><input type="text"
                                    id="config-prefix" class="form-input" placeholder="MDR" maxlength="5"></div>
                            <div class="form-group"><label class="form-label">Validez</label><select
                                    id="config-validity" class="form-select">
                                    <option value="3">3 d√≠as</option>
                                    <option value="5">5 d√≠as</option>
                                    <option value="7" selected>7 d√≠as</option>
                                    <option value="10">10 d√≠as</option>
                                </select></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label class="form-label">Moneda</label><select id="config-currency"
                                    class="form-select">
                                    <option value="USD">USD</option>
                                    <option value="MXN">MXN</option>
                                </select></div>
                            <div class="form-group"><label class="form-label">Tipo cambio</label><input type="number"
                                    id="config-exchange" class="form-input" placeholder="17.5" step="0.1"></div>
                        </div>
                        <div class="form-group"><label class="form-label">Texto legal</label><textarea id="config-legal"
                                class="form-textarea" placeholder="Precios sujetos a disponibilidad..."></textarea>
                        </div>
                    </div>
                    <div class="config-section">
                        <div class="config-section-title">üé® Apariencia</div>
                        <div class="toggle-row"><span class="toggle-label">Modo oscuro</span><label
                                class="toggle"><input type="checkbox" id="config-darkmode"
                                    onchange="App.toggleDarkMode()"><span class="toggle-slider"></span></label></div>
                    </div>
                    <div class="config-section">
                        <div class="config-section-title">ü§ñ IA</div>
                        <div class="form-group"><label class="form-label">OpenAI API Key</label><input type="password"
                                id="config-ai-key" class="form-input" placeholder="sk-..."></div>
                        <div class="form-group"><label class="form-label">Modelo (con visi√≥n)</label><select
                                id="config-ai-model" class="form-select" onchange="App.handleAIModelSelect()">
                                <option value="gpt-4o-mini">gpt-4o-mini (r√°pido, econ√≥mico)</option>
                                <option value="gpt-4o">gpt-4o (equilibrado)</option>
                                <option value="gpt-4.1">gpt-4.1 (avanzado)</option>
                                <option value="gpt-4.1-mini">gpt-4.1-mini (r√°pido, avanzado)</option>
                                <option value="gpt-5.1">gpt-5.1 (premium)</option>
                                <option value="gpt-5.1-mini">gpt-5.1-mini (r√°pido, premium)</option>
                                <option value="custom">Otro modelo</option>
                            </select></div>
                        <div class="form-group" id="config-ai-model-custom-group" style="display:none;"><label
                                class="form-label">Nombre del modelo</label><input type="text"
                                id="config-ai-model-custom" class="form-input" placeholder="ej. gpt-4.1-preview"></div>
                        <p class="muted" style="font-size:12px;margin-top:-4px;">Elige un modelo con visi√≥n. Para resultados premium usa gpt-4o o gpt-4.1. Se guarda solo en este dispositivo.</p>
                    </div>
                    <button class="btn-primary btn-block" onclick="App.saveConfig()">üíæ Guardar</button>
                    <div class="config-section" style="margin-top:24px;">
                        <div class="config-section-title">üì§ Datos</div>
                        <div class="action-row"><button class="btn-secondary" onclick="App.exportAllData()">üì§
                                Exportar</button><label class="btn-secondary" style="cursor:pointer;">üì• Importar<input
                                    type="file" accept=".json" onchange="App.importData(event)"
                                    style="display:none;"></label>
                        </div><button class="btn-danger btn-block" style="margin-top:12px;"
                            onclick="App.clearAllData()">üóëÔ∏è
                            Borrar datos</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <nav class="bottom-nav">
        <button class="nav-item active" data-tab="inicio" onclick="App.showTab('inicio', this)">
            <span class="icon">üè†</span>
            <span>Inicio</span>
        </button>
        <button class="nav-item" data-tab="cotizar" onclick="App.showTab('cotizar', this)">
            <span class="icon">üìù</span>
            <span>Cotizar</span>
        </button>
        <button class="nav-item" data-tab="info" onclick="App.showTab('info', this)">
            <span class="icon">üìö</span>
            <span>Info</span>
        </button>
        <button class="nav-item" data-tab="tools" onclick="App.showTab('tools', this)">
            <span class="icon">üßÆ</span>
            <span>Tools</span>
        </button>
        <button class="nav-item" data-tab="ajustes" onclick="App.showTab('ajustes', this)">
            <span class="icon">‚öôÔ∏è</span>
            <span>Ajustes</span>
        </button>
    </nav>

    <div id="toast" class="toast"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/ai-quoter.js"></script>
    <script src="js/pdf-generator.js"></script>
    <script src="js/form-validation.js"></script>
    <script src="js/form-enhancer.js"></script>
    <script src="js/crm.js"></script>
    <script src="js/pipeline.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/advanced-quotes.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/personalization.js"></script>
    <script src="js/pwa.js"></script>
    <script src="js/tools.js"></script>
    <script src="js/quotes.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="js/analytics-ui.js"></script>
</body>

</html>
